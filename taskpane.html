<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Contact Extractor Pro</title>
    
    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
    
    <!-- Styling -->
    <link rel="stylesheet" type="text/css" href="taskpane.css" />
</head>
<body class="ms-font-m ms-welcome ms-Fabric">
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-container">
        <div class="loading-spinner"></div>
        <div class="loading-text">Initializing Contact Extractor Pro...</div>
    </div>

    <!-- Main Container -->
    <div id="mainContainer" class="main-container" style="display: none;">
        
        <!-- Futuristic Header -->
        <div class="header-section">
            <div class="header-title">CONTACT EXTRACTOR</div>
            <div class="header-line"></div>
            <div class="header-subtitle">AI-POWERED EXTRACTION</div>
        </div>

        <!-- Stats Section -->
        <div id="statsSection" class="stats-section" style="display: none;">
            <div class="stats-text" id="statsText">FOUND 0 SIGNATURES</div>
            <div class="stats-subtitle">Review and process contacts below</div>
        </div>

        <!-- No Signatures Section -->
        <div id="noSignaturesSection" class="no-signatures-section" style="display: none;">
            <div class="error-title">NO SIGNATURES DETECTED</div>
            <div class="error-subtitle">No email signatures were found in this message</div>
            <div class="error-hint">Use the manual input below to add contacts manually</div>
        </div>

        <!-- Contacts Container -->
        <div id="contactsContainer" class="contacts-container"></div>

        <!-- Manual Input Section -->
        <div class="manual-input-section">
            <div class="manual-input-header">
                <div class="manual-input-title">MANUAL INPUT</div>
                <div class="manual-input-subtitle">Paste signature for manual processing</div>
            </div>
            
            <textarea id="manualSignatureInput" 
                      class="manual-signature-input" 
                      placeholder="Paste the complete signature text here..."
                      rows="4"></textarea>
            
            <button id="extractButton" class="extract-button" onclick="processManualSignature()">
                <span class="button-text">EXTRACT & EDIT</span>
            </button>
        </div>

        <!-- Action Buttons -->
        <div id="actionButtons" class="action-buttons" style="display: none;">
            <button id="refreshButton" class="secondary-button" onclick="refreshExtraction()">
                <span class="button-text">üîÑ REFRESH</span>
            </button>
        </div>

    </div>

    <!-- Contact Edit Modal -->
    <div id="editModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">EDIT CONTACT</div>
                <div class="modal-subtitle">Complete all fields before saving</div>
                <div class="modal-line"></div>
            </div>
            
            <div class="modal-body">
                <form id="contactForm" class="contact-form">
                    
                    <div class="input-group">
                        <label class="input-label">COMPANY</label>
                        <input type="text" id="company" class="form-input" />
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">SECTOR</label>
                        <select id="sector" class="form-select">
                            <option value="">Select sector...</option>
                            <option value="Government">Government</option>
                            <option value="Semi-government">Semi-government</option>
                            <option value="Private">Private</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">INDUSTRY</label>
                        <select id="industry" class="form-select">
                            <option value="">Select industry...</option>
                            <option value="Accounting, Finance & Banking">Accounting, Finance & Banking</option>
                            <option value="Agriculture, Food & Beverage">Agriculture, Food & Beverage</option>
                            <option value="Arts, Media & Entertainment">Arts, Media & Entertainment</option>
                            <option value="Construction, Real Estate & Infrastructure">Construction, Real Estate & Infrastructure</option>
                            <option value="Consulting, Legal & Professional Services">Consulting, Legal & Professional Services</option>
                            <option value="Consumer Goods, Retail & Hospitality">Consumer Goods, Retail & Hospitality</option>
                            <option value="Education, Training & Non-Profit">Education, Training & Non-Profit</option>
                            <option value="Energy, Utilities & Environmental Services">Energy, Utilities & Environmental Services</option>
                            <option value="Government, Public Policy & International Affairs">Government, Public Policy & International Affairs</option>
                            <option value="Healthcare, Pharmaceuticals & Life Sciences">Healthcare, Pharmaceuticals & Life Sciences</option>
                            <option value="Human Resources & Career Services">Human Resources & Career Services</option>
                            <option value="Information Technology, Software & Digital Services">Information Technology, Software & Digital Services</option>
                            <option value="Logistics, Transportation & Supply Chain">Logistics, Transportation & Supply Chain</option>
                            <option value="Manufacturing & Industrial Engineering">Manufacturing & Industrial Engineering</option>
                            <option value="Marketing, Advertising & Communications">Marketing, Advertising & Communications</option>
                            <option value="Science, Research & Innovation">Science, Research & Innovation</option>
                            <option value="Security, Defense & Aerospace">Security, Defense & Aerospace</option>
                            <option value="Sports, Recreation & Wellness">Sports, Recreation & Wellness</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">NAME</label>
                        <input type="text" id="name" class="form-input" />
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">TITLE</label>
                        <input type="text" id="title" class="form-input" />
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">EMAIL</label>
                        <input type="email" id="email" class="form-input" />
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">PHONE</label>
                        <input type="text" id="phone" class="form-input" />
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">PHONE 2</label>
                        <input type="text" id="phone2" class="form-input" />
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">WEBSITE</label>
                        <input type="url" id="website" class="form-input" />
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">LINKEDIN</label>
                        <input type="url" id="linkedin" class="form-input" />
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">ADDRESS</label>
                        <textarea id="address" class="form-textarea" rows="3"></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">NOTES</label>
                        <textarea id="notes" class="form-textarea" rows="3"></textarea>
                    </div>
                    
                </form>
            </div>
            
            <div class="modal-footer">
                <button id="saveButton" class="save-button" onclick="saveContact()">
                    <span class="button-text">üíæ SAVE CONTACT</span>
                </button>
                <button id="cancelButton" class="cancel-button" onclick="closeEditModal()">
                    <span class="button-text">‚ùå CANCEL</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Success/Error Messages -->
    <div id="messageContainer" class="message-container" style="display: none;">
        <div id="messageContent" class="message-content"></div>
    </div>

    <!-- Configuration -->
    <script type="text/javascript" src="config.js"></script>
    
    <!-- Main Application Logic -->
    <script type="text/javascript" src="taskpane.js"></script>
    
</body>
</html>
